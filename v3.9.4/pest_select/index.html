<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Selection with PEtab-select · PEtab.jl</title><meta name="title" content="Model Selection with PEtab-select · PEtab.jl"/><meta property="og:title" content="Model Selection with PEtab-select · PEtab.jl"/><meta property="twitter:title" content="Model Selection with PEtab-select · PEtab.jl"/><meta name="description" content="Documentation for PEtab.jl."/><meta property="og:description" content="Documentation for PEtab.jl."/><meta property="twitter:description" content="Documentation for PEtab.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom_theme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PEtab.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Extended Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../petab_simcond/">Simulation conditions</a></li><li><a class="tocitem" href="../petab_preeq_simulations/">Steady-State Simulations (Pre-Equilibration)</a></li><li><a class="tocitem" href="../petab_event/">Events (callbacks, dosages, etc.)</a></li><li><a class="tocitem" href="../petab_cond_specific/">Simulation Condition-Specific Parameters</a></li><li><a class="tocitem" href="../petab_obs_noise/">Noise and Observable Parameters</a></li><li><a class="tocitem" href="../import_petab/">Importing PEtab Standard Format</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Parameter Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pest_method/">Parameter Estimation Methods</a></li><li><a class="tocitem" href="../pest_plot/">Plotting Estimation Results</a></li><li><a class="tocitem" href="../pest_algs/">Available and Recommended Algorithms</a></li><li class="is-active"><a class="tocitem" href>Model Selection with PEtab-select</a><ul class="internal"><li><a class="tocitem" href="#Model-Selection-Example"><span>Model Selection Example</span></a></li></ul></li><li><a class="tocitem" href="../pest_custom/">Wrapping Optimization Packages</a></li></ul></li><li><a class="tocitem" href="../inference/">Bayesian Inference</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../grad_hess_methods/">Gradient and Hessian Methods</a></li><li><a class="tocitem" href="../default_options/">Default Options</a></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Performance Tips</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../nonstiff_models/">Non-Biology (Non-Stiff) Models</a></li><li><a class="tocitem" href="../Beer/">Condition-Specific Parameters</a></li><li><a class="tocitem" href="../Bachmann/">Adjoint Sensitivity Analysis (Large Models)</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li><li><a class="tocitem" href="../FAQ/">FAQ</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Parameter Estimation</a></li><li class="is-active"><a href>Model Selection with PEtab-select</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Selection with PEtab-select</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sebapersson/PEtab.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sebapersson/PEtab.jl/blob/main/docs/src/pest_select.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-Selection-with-PEtab-Select"><a class="docs-heading-anchor" href="#Model-Selection-with-PEtab-Select">Model Selection with PEtab Select</a><a id="Model-Selection-with-PEtab-Select-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Selection-with-PEtab-Select" title="Permalink"></a></h1><p>Sometimes we have competing hypotheses (model structures) that we want to compare to ultimately select the best model/hypothesis. There are <a href="https://en.wikipedia.org/wiki/Stepwise_regression">various approaches</a> for model selection, such as forward search, backward search, and exhaustive search, where models are compared based on information criteria like AIC or BIC. Additionally, there are efficient algorithms that combine both backward and forward search, such as Famos [<a href="../references/#gabel2019famos">11</a>]. All these model selection methods are supported by the Python package <a href="https://github.com/PEtab-dev/petab_select">PEtab Select</a>, for which PEtab.jl provides an interface.</p><p>This advanced documentation page assumes that you know how to import and crate PEtab problems in the standard format (a tutorial can be found <a href="../import_petab/#import_petab_problem">here</a>) as well as the basics of multi-start parameter estimation with PEtab.jl (a tutorial can be found <a href="../pest_method/#pest_methods">here</a>). Additionally, since PEtab Select is a Python package, to run this code you need to have <a href="https://github.com/JuliaPy/PyCall.jl">PyCall.jl</a> installed, and you must build PyCall with a Python environment that has <a href="https://github.com/PEtab-dev/petab_select">petab_select</a> installed:</p><pre><code class="language-julia hljs">using PyCall
# Path to Python executable with PEtab Select installed
path_python_exe = &quot;path_python&quot;
ENV[&quot;PYTHON&quot;] = path_python_exe
# Build PyCall with the PEtab Select Python environment
import Pkg
Pkg.build(&quot;PyCall&quot;)</code></pre><div class="admonition is-info" id="Note-162afe91052f9567"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-162afe91052f9567" title="Permalink"></a></header><div class="admonition-body"><p>Version &gt;0.3 of PEtab Select must be installed.</p></div></div><div class="admonition is-info" id="Note-58567847f668852f"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-58567847f668852f" title="Permalink"></a></header><div class="admonition-body"><p>Model selection is currently only possible for problem in the <a href="https://github.com/PEtab-dev/petab_select">PEtab Select</a> standard format. We plan to add a Julia interface.</p></div></div><h2 id="Model-Selection-Example"><a class="docs-heading-anchor" href="#Model-Selection-Example">Model Selection Example</a><a id="Model-Selection-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Selection-Example" title="Permalink"></a></h2><p>PEtab.jl provides support for PEtab Select through the <code>petab_select</code> function:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PEtab.petab_select-pest_select" href="#PEtab.petab_select-pest_select"><code>PEtab.petab_select</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">petab_select(path_yaml, alg; nmultistarts = 100, kwargs...) -&gt; path_res</code></pre><p>For a PEtab-select problem, perform model selection with the method specified in the PEtab select problem files. Returns the path (<code>path_res</code>) to a YAML-file with model selection results.</p><p>The general model selection (e.g. to use forward-search) options are specified in the PEtab-select files. For details on how to set this up, see the PEtab-select <a href="https://github.com/PEtab-dev/petab_select">documentation</a>.</p><p>For each round of model selection, the candidate models are parameter estimated using multi-start parameter estimation, with <code>nmultistarts</code> performed for each model. The objective values obtained from parameter estimation are then used for the next round of  model evaluation.</p><p>A list of available and recommended optimization algorithms (<code>alg</code>) can be found in the package documentation and <a href="../API/#PEtab.calibrate"><code>calibrate</code></a> documentation.</p><p>See also <a href="../API/#PEtab.calibrate_multistart"><code>calibrate_multistart</code></a>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs</code>: The same keywords accepted by <a href="../API/#PEtabODEProblem"><code>PEtabODEProblem</code></a> and <a href="../API/#PEtab.calibrate"><code>calibrate</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sebapersson/PEtab.jl/blob/d077938f92ae7ab6b47b8d549b81b4c2375e83f7/src/parameter_estimation/petab_select.jl#L1-L24">source</a></section></article><p>As an example, for a simple signaling model (files can be downloaded from <a href="https://github.com/sebapersson/PEtab.jl/tree/main/docs/src/assets/petab_select">here</a>), you can run PEtab Select with the <code>IPNewton()</code> algorithm:</p><pre><code class="language-julia hljs">using Optim, PEtab, PyCall
path_yaml = joinpath(@__DIR__, &quot;assets&quot;, &quot;petab_select&quot;, &quot;petab_select_problem.yaml&quot;)
path_res = petab_select(path_yaml, IPNewton(); nmultistarts=10)</code></pre><pre><code class="language-julia hljs">┌ Info: PEtab select problem info
│ Method: brute_force
└ Criterion: AIC
[ Info: Model selection round 1 with 1 candidates - as the code compiles in this round it takes extra long time https://xkcd.com/303/
[ Info: Callibrating model M1_1
[ Info: Saving results for best model at /home/sebpe/.julia/dev/PEtab/docs/build/assets/petab_select/PEtab_select_brute_force_AIC.yaml</code></pre><p>Where the YAML file storing the model selection results is saved at <code>path_res</code>.</p><div class="citation noncanonical"><dl><dt>[11]</dt><dd><div>M. Gabel, T. Hohl, A. Imle, O. T. Fackler and F. Graw. <em>FAMoS: A Flexible and dynamic Algorithm for Model Selection to analyse complex systems dynamics</em>. PLOS Computational Biology <strong>15</strong>, e1007230 (2019).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pest_algs/">« Available and Recommended Algorithms</a><a class="docs-footer-nextpage" href="../pest_custom/">Wrapping Optimization Packages »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 10:13">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
