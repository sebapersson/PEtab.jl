import{_ as l,C as n,c as h,o,aA as s,j as e,G as a,a as r,w as d}from"./chunks/framework.DLYJsqdg.js";const _=JSON.parse('{"title":"Model selection with PEtab Select","description":"","frontmatter":{},"headers":[],"relativePath":"tutorials/parameter_estimation/model_selection.md","filePath":"tutorials/parameter_estimation/model_selection.md","lastUpdated":null}'),p={name:"tutorials/parameter_estimation/model_selection.md"},k={class:"jldocstring custom-block",open:""};function c(b,i,g,f,m,u){const t=n("Badge");return o(),h("div",null,[i[4]||(i[4]=s('<h1 id="petab_select" tabindex="-1">Model selection with PEtab Select <a class="header-anchor" href="#petab_select" aria-label="Permalink to &quot;Model selection with PEtab Select {#petab_select}&quot;">​</a></h1><p>Model selection compares competing model structures to identify a structure that best explains the data. Common strategies include forward, backward, and exhaustive search, where candidates are ranked using information criteria such as AIC or BIC. Approaches combining forward and backward search also exist, such as FAMoS [<a href="/PEtab.jl/previews/PR343/references#gabel2019famos">14</a>]. All these methods are supported by the <a href="https://github.com/PEtab-dev/petab_select" target="_blank" rel="noreferrer">PEtab Select</a> package [<a href="/PEtab.jl/previews/PR343/references#pathirana2025petab">11</a>], for which PEtab.jl provides an interface.</p><p>This tutorial showcases PEtab Select and assumes familiarity with importing PEtab problems in the standard format (see <a href="/PEtab.jl/previews/PR343/tutorials/define_problem/standard_format#import_petab_problem">Importing PEtab problems</a>) and with multi-start parameter estimation in PEtab.jl (see the <a href="/PEtab.jl/previews/PR343/tutorials/parameter_estimation/extended_tutorial#pest_methods">extended estimation tutorial</a>).</p><div class="tip custom-block"><p class="custom-block-title">PEtab Select requires the PEtab standard format</p><p>For PEtab Select, PEtab.jl currently only supports problems in the PEtab standard, not problems defined via the Julia interface in PEtab.jl. If Julia-interface support would be useful, please open an issue so its implementation can be prioritized.</p></div><h2 id="Model-selection-example" tabindex="-1">Model selection example <a class="header-anchor" href="#Model-selection-example" aria-label="Permalink to &quot;Model selection example {#Model-selection-example}&quot;">​</a></h2><p>PEtab.jl interfaces with PEtab Select via the <code>petab_select</code> function:</p>',6)),e("details",k,[e("summary",null,[i[0]||(i[0]=e("a",{id:"PEtab.petab_select-tutorials-parameter_estimation-model_selection",href:"#PEtab.petab_select-tutorials-parameter_estimation-model_selection"},[e("span",{class:"jlbinding"},"PEtab.petab_select")],-1)),i[1]||(i[1]=r()),a(t,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[3]||(i[3]=s('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">petab_select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path_yaml, alg; nmultistarts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> path_res</span></span></code></pre></div><p>For a PEtab-select problem, perform model selection with the method specified in the PEtab select problem files. Returns the path (<code>path_res</code>) to a YAML-file with model selection results.</p><p>The general model selection (e.g. to use forward-search) options are specified in the PEtab-select files. For details on how to set this up, see the PEtab-select <a href="https://github.com/PEtab-dev/petab_select" target="_blank" rel="noreferrer">documentation</a>.</p><p>For each round of model selection, the candidate models are parameter estimated using multi-start parameter estimation, with <code>nmultistarts</code> performed for each model. The objective values obtained from parameter estimation are then used for the next round of model evaluation.</p><p>A list of available and recommended optimization algorithms (<code>alg</code>) can be found in the package documentation and <a href="/PEtab.jl/previews/PR343/API#PEtab.calibrate"><code>calibrate</code></a> documentation.</p><p>See also <a href="/PEtab.jl/previews/PR343/API#PEtab.calibrate_multistart"><code>calibrate_multistart</code></a>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs</code>: The same keywords accepted by <a href="/PEtab.jl/previews/PR343/API#PEtabODEProblem"><code>PEtabODEProblem</code></a> and <a href="/PEtab.jl/previews/PR343/API#PEtab.calibrate"><code>calibrate</code></a>.</li></ul>',8)),a(t,{type:"info",class:"source-link",text:"source"},{default:d(()=>[...i[2]||(i[2]=[e("a",{href:"https://github.com/sebapersson/PEtab.jl/blob/1e05d31a4db95a7f7d4d2d3b8b35a63c83698751/src/parameter_estimation/petab_select.jl#L1-L24",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[5]||(i[5]=s(`<p>As an example, for a simple signaling model (files are available <a href="https://github.com/sebapersson/PEtab.jl/tree/main/docs/src/assets/petab_select" target="_blank" rel="noreferrer">here</a>), PEtab Select can be run as:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Optim, PEtab, PEtabSelect</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">path_yaml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> joinpath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@__DIR__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;assets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;petab_select&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;petab_select_problem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">path_res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> petab_select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path_yaml, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IPNewton</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); nmultistarts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model selection with method FORWARD and criteria AIC</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Round 1 with 1 candidates - as the code compiles this round it takes extra long time https://xkcd.com/303/</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_0</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Round 2 with 3 candidates</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_1</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_2</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_3</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Round 3 with 3 candidates</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_4</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_5</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_6</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Round 4 with 1 candidates</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Calibrating model M1_7</span></span>
<span class="line"><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">[ </span><span style="--shiki-light:#1b7c83;--shiki-light-font-weight:bold;--shiki-dark:#39c5cf;--shiki-dark-font-weight:bold;">Info: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Saving results for best model at /home/runner/work/PEtab.jl/PEtab.jl/docs/build/tutorials/parameter_estimation/../../assets/petab_select/PEtab_select_FORWARD_AIC.yaml</span></span></code></pre></div><p>Here, <code>IPNewton()</code> specifies the optimizer used for parameter estimation within each model evaluation, and <code>nmultistarts = 10</code> sets the number of multi-starts per model. The YAML file with model selection results is saved to <code>path_res</code>.</p><h2 id="References" tabindex="-1">References <a class="header-anchor" href="#References" aria-label="Permalink to &quot;References {#References}&quot;">​</a></h2><ol><li><p>D. Pathirana, F. T. Bergmann, D. Doresic, P. Lakrisenko, S. Persson, N. Neubrand, J. Timmer, C. Kreutz, H. Binder, M. Cvijovic and others. <em>PEtab Select: specification standard and supporting software for automated model selection</em>, bioRxiv, 2025–05 (2025).</p></li><li><p>M. Gabel, T. Hohl, A. Imle, O. T. Fackler and F. Graw. <em>FAMoS: A Flexible and dynamic Algorithm for Model Selection to analyse complex systems dynamics</em>. PLOS Computational Biology <strong>15</strong>, e1007230 (2019).</p></li></ol>`,6))])}const w=l(p,[["render",c]]);export{_ as __pageData,w as default};
